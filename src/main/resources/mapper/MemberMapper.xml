<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="thedrivers.upbus.mapper.MemberMapper">

	<resultMap type="Member" id="memberResultMap">
		<result property="memberId" 						column="member_id"/>
		<result property="memberPw" 						column="member_pw"/>
		<result property="memberName" 						column="member_name"/>
		<result property="memberEmail" 						column="member_email"/>
		<result property="memberGender" 					column="member_gender"/>
		<result property="memberAddr" 						column="member_addr"/>
		<result property="memberPhone_number" 				column="member_phone_number"/>
		<result property="memberBirth" 						column="member_birth"/>
		<result property="memberMile" 						column="member_mile"/>
		<result property="memberSign" 						column="member_sign"/>
		<result property="gradeCode" 						column="grade_code"/>
		<result property="memberExp" 						column="member_exp"/>
		<result property="memberStatus" 					column="member_status"/>
		<result property="memberImage" 						column="member_image"/>
		<result property="classStudentDivision" 			column="class_student_division"/>
		<result property="classTeacherDivision" 			column="class_teacher_division"/>
		<result property="memberLogin_history_code" 		column="member_login_history_code"/>
		<result property="memberDivision" 					column="member_division"/>
		<!-- collection 복잡한 맵핑 has many 관계 -->
	</resultMap>
	
	
	<insert id="Signup" parameterType="Member">
		INSERT INTO member
		(   member_id
		   ,member_pw
		   ,member_name
		   ,member_email
		   ,member_gender
		   ,member_addr
		   ,member_phone_number
		   ,member_birth
		   ,member_sign
		) VALUES (
		    #{memberId}
		   ,#{memberPw}
		   ,#{memberName}
		   ,#{memberEmail}
		   ,#{memberGender}
		   ,#{memberAddr}
		   ,#{memberPhone_number}
		   ,#{memberBirth}
		   , CURDATE()
		);	
	</insert>
	
	<update id="modify" parameterType="Member">
		UPDATE member
		<trim prefix="SET" suffixOverrides=",">
			<if test="memberPw != null and memberPw != ''.toString()">
				member_pw = #{memberPw},
			</if>
			<if test="memberName != null and memberName != ''.toString()">
				member_name = #{memberName},
			</if>
			<if test="memberEmail != null and memberEmail != ''.toString()">
				member_email = #{memberEmail},
			</if>
			<if test="memberAddr != null and memberAddr != ''.toString()">
				member_addr = #{memberAddr},
			</if>
			<if test="memberPhone_number != null and memberPhone_number != ''.toString()">
				member_phone_number = #{memberPhone_number},
			</if>
			<if test="memberBirth != null and memberBirth != ''.toString()">
				member_birth = #{memberBirth},
			</if>
			<if test="memberImage != null and memberImage != ''.toString()">
				member_image = #{memberImage},
			</if>
		</trim>
		WHERE
			member_id=#{memberId}
	</update>
	
	<select id="getMemberInfoById" parameterType="String" resultType="Member">
		SELECT 
			  member_id					AS memberId
			, member_pw					AS memberPw
			, member_name				AS memberName
			, member_email				AS memberEmail
			, member_addr				AS memberAddr
			, member_phone_number		AS memberPhone_number
			, member_birth				AS memberBirth
			, member_image				AS memberImage
		FROM 
			member
		WHERE
			member_id = #{memberId};
	</select>
	
	<select id="getMemberList" resultMap="memberResultMap">
		SELECT 
			member_id, 
			member_name, 
			member_email, 
			member_gender, 
			member_addr, 
			member_phone_number, 
			member_birth, 
			member_mile, 
			member_sign, 
			grade_code, 
			member_exp, 
			member_status, 
			class_student_division, 
			class_teacher_division, 
			member_division
		FROM 
			member order by member_sign ASC;
	</select>
	
	<select id="getCompareMemberId" resultType="String">
		SELECT 
			member_id
		FROM 
			member
		WHERE
			member_id = #{memberId}
	</select>
	
	<delete id="memberDelete" parameterType="String">
		DELETE
		FROM 
			member
		WHERE
			member_id = #{memberId};
	</delete>
</mapper>